{# templates/lyricfind_records.html #}
{% extends "base.html" %}
{% load static %}

{% block title %}LyricFind · Records | KLAIM{% endblock %}
{% block body_class %}lyricfind-records-page{% endblock %}

{# ——— CSS exclusivo de la vista ——— #}
{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/pages/lyricfind_records.css' %}">
{% endblock %}

{# ——— CONTENIDO ——— #}
{% block content %}
<div class="container">
  {# FILTROS + CONTADOR #}
  <form class="filter-bar" method="get">
    <strong>Total records: {{ total_registros }}</strong>

    <label>
      From
      <input type="date" name="from" value="{{ from }}">
    </label>

    <label>
      To
      <input type="date" name="to" value="{{ to }}">
    </label>

    <button type="submit" class="btn btn--primary">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
           stroke="currentColor" stroke-width="2" stroke-linecap="round"
           stroke-linejoin="round">
        <path d="M21 3v18c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2V3c0-1.1.9-2 2-2h7l2 2h7c1.1 0 2 .9 2 2z"/>
        <circle cx="9" cy="9" r="2"/>
        <path d="M15 13a2 2 0 1 1 0-4 2 2 0 0 1 0 4z"/>
      </svg>
      Filter
    </button>
  </form>

  {# TABLA #}
  <div class="table-container">
    <div class="section-header">
      <h2 class="section-title">LyricFind Records</h2>
    </div>

    <table class="data-table">
      <thead>
        <tr>
          <th>Klaim</th><th>Title</th><th>Artist</th><th>ISRC</th>
          <th>Status</th><th>Date</th>
        </tr>
      </thead>
      <tbody>
        {% for reg in page_obj %}
        <tr>
          <td>{{ reg.obra_id }}</td>
          <td>{{ reg.obra.titulo }}</td>
          <td>{{ reg.artista_unico.nombre_artista }}</td>
          <td>{{ reg.isrc.codigo_isrc }}</td>
          <td>
            <span class="status-badge {% if reg.estado == 'Completed' %}success{% else %}warning{% endif %}">
              {{ reg.estado }}
            </span>
          </td>
          <td>{{ reg.fecha_proceso|date:"Y-m-d" }}</td>
        </tr>
        {% empty %}
        <tr><td colspan="6" class="empty-state">No records found.</td></tr>
        {% endfor %}
      </tbody>
    </table>

    {# PAGINACIÓN – usamos .pagination para heredar estilos globales #}
    <nav class="pagination">
      {% if page_obj.has_previous %}
        <a href="?{% if from %}from={{from}}&{% endif %}{% if to %}to={{to}}&{% endif %}page=1">&laquo;</a>
        <a href="?{% if from %}from={{from}}&{% endif %}{% if to %}to={{to}}&{% endif %}page={{ page_obj.previous_page_number }}">&lsaquo;</a>
      {% else %}
        <span class="disabled">&laquo;</span><span class="disabled">&lsaquo;</span>
      {% endif %}

      <span class="current">
        Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
      </span>

      {% if page_obj.has_next %}
        <a href="?{% if from %}from={{from}}&{% endif %}{% if to %}to={{to}}&{% endif %}page={{ page_obj.next_page_number }}">&rsaquo;</a>
        <a href="?{% if from %}from={{from}}&{% endif %}{% if to %}to={{to}}&{% endif %}page={{ page_obj.paginator.num_pages }}">&raquo;</a>
      {% else %}
        <span class="disabled">&rsaquo;</span><span class="disabled">&raquo;</span>
      {% endif %}
    </nav>
  </div>
</div>
{% endblock %}

</body>
</html>
